# TMUX CONFIG SETTINGS

###########
# General #
###########

# Replace C-b prefix with Alt+Space (so it won't clash with vim)
unbind C-b
set-option -g prefix C-Space
set-window-option -g mode-keys vi

# Prevent ssh from renaming window name
set-option -g allow-rename off

# Highlight active window
# set-window-option -g window-status-current-bg red

# Enable mouse
setw -g mouse on

# Address vim mode switching delay
set -s escape-time 0

# Increase scrollback buffer size
set -g history-limit 100000

# Tmux messages are displayed for 2 seconds
set -g display-time 2000

# Refresh 'status-left' and 'status-right' more often
set -g status-interval 5

# Focus events enabled for terminals that support them
set -g focus-events on

# Super useful when using "grouped sessions" and multi-monitor setup
setw -g aggressive-resize on

# Start window numbering at 1
set -g base-index 1

# Set parent terminal title to reflect current window in tmux session 
set -g set-titles on
set -g set-titles-string "#I:#W [#P:#{pane_current_command}]"

# Automatically renumber windows
set -g renumber-windows on

#############
# Shortcuts #
#############

# Replace C-b prefix with Alt+Space (so it won't clash with vim)
bind -n C-k send-keys -R \; send-keys C-l \; clear-history

# Custom keys to change pane without using prefix
# Switch panes using Alt-arrow without prefix
bind -n C-l select-pane -L
bind -n C-h select-pane -R
bind -n C-k select-pane -U
bind -n C-j select-pane -D

# Swapping Tmux windows
bind-key -n C-S-Left swap-window -t -1
bind-key -n C-S-Right swap-window -t +1

# Bind prefix-j to switch to the previous session
bind-key j switch-client -p
# Bind prefix-k to switch to the next session
bind-key k switch-client -n

# Split panes using | and -
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"
unbind '"'
unbind %

# Reload tmux configuration
bind r source-file ~/.tmux.conf \; display "Reloaded tmux.conf"

# Bind prefix+36 to select last window instead of window 0
bind 0 select-window -t:$

# Bind M-(number) to select window without having to use prefix
# Bind Ctrl-(number) to select window like Chrome tabs

# Switch windows using Alt+Shift+number (no prefix)
bind -n M-q select-window -t 1   # Alt+Shift+1 → window 1
bind -n M-w select-window -t 2   # Alt+Shift+2 → window 2
bind -n M-e select-window -t 3   # Alt+Shift+3 → window 3
bind -n M-r select-window -t 4   # Alt+Shift+4 → window 4
bind -n M-t select-window -t 5   # Alt+Shift+5 → window 5
bind -n M-y select-window -t 6   # Alt+Shift+6 → window 6
bind -n M-u select-window -t 7   # Alt+Shift+7 → window 7
bind -n M-i select-window -t 8   # Alt+Shift+8 → window 8
bind -n M-o select-window -t 9   # Alt+Shift+9 → window 9
bind -n M-p select-window -t 0   # Alt+Shift+0 → window 0

# Capture pane content and store it into ~/tmux.log
bind-key S capture-pane -b temp-capture-buffer -S - \; save-buffer -b temp-capture-buffer ~/tmux.log \; delete-buffer -b temp-capture-buffer \; display "Pane content stored at ~/tmux.log"


# Bind C-S-n to create a new tmux session
# Create a new session with the current date and time as the session name
# Function to generate the next session name dynamically
# Function to create a new session with an incremented name
# Create a new session with an incremented session name

######
# UI #
######

# Set default terminal
set -g default-terminal "screen-256color"

# Modes
setw -g clock-mode-colour colour5
setw -g mode-style 'fg=colour1 bg=colour18 bold'

# Panes
set -g pane-border-style 'fg=colour244 bg=colour235'
set -g pane-active-border-style 'fg=colour77 bg=colour235'
set -g pane-border-format ' [#P] <#{pane_current_command}> @ #{pane_current_path} #{?window_zoomed_flag,#[fg=colour228]Z#[fg=colour77] ,}'
set -g pane-border-status 'top'

# Statusbar
set -g status-style 'bg=colour234 fg=colour250'
set -g status-left '#[fg=colour228,bg=colour234] #S' # session name
set -g status-right '#[fg=colour250,bg=colour236] %d %b %H:%M ' # date/clock
set -g status-right-length 50
set -g status-left-length 50

setw -g window-status-current-style 'fg=colour1 bg=colour28 bold'
setw -g window-status-current-format ' #I#[fg=colour249]:#[fg=colour255]#W#[fg=colour250]#F '

setw -g window-status-style 'fg=colour9 bg=colour236'
setw -g window-status-format ' #I#[fg=colour237]:#[fg=colour250]#W#[fg=colour244]#F '
setw -g window-status-bell-style 'fg=colour255 bg=colour1 bold'
setw -g window-status-separator ''

# Messages
set -g message-style 'fg=colour237 bg=colour3 bold'

# -----------------------------------------------------------------------------
# WILL RESTORE A  NEOVIM SESSION
set -g @resurrect-strategy-nvim 'session' 
set -g @resurrect-capture-pane-contents 'on'
# prefix(Ctrl-a) and Ctrl-s will save a Vim session
# To restore prefix(Crtl-a) and Ctrl-r

# Custom binding to list and choose a saved tmux session
bind-key P run 'tmux-resurrect list'  # Show available saved sessions
bind-key R run 'tmux-resurrect choose' # Choose and restore a saved session interactively

# Create a new session with a custom name (C-S-N)
bind-key  N command-prompt "new-session -s '%%'"

# Rename the current session (C-S-R)
bind-key  R command-prompt "rename-session '%%'"


# Bind prefix+F to filter sessions by a user-provided prefix and switch to the first matching session
bind-key F command-prompt "run 'tmux list-sessions | grep -E \"^%%\" | head -n 1 | cut -d: -f1 | xargs tmux switch-client -t'"
# -----------------------------------------------------------------------------

# LIST OF PLUGINS
set-option -sg escape-time 10

# Github plugin :
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'git@github.com/user/plugin'
# set -g @plugin 'git@bitbucket.com/user/plugin'

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
# A PLUGIN TO SAVE SESSIONS (USE IT WITH TPOPE/VIM-OBSESSION VIM PLUGIN WILL SAVE VIM SESSIONS)
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Initialize TMUX plugin manager
run '~/.tmux/plugins/tpm/tpm'

